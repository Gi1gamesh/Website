---
title: Writing unit tests for RTK Query 
description: test
created:  1667489858619
words: 0
tags: ["Testing"]
author: Kevin Mckenny
---


Recently I wrote a microservice that used [RTK Query](https://redux-toolkit.js.org/rtk-query/overview). This article will outline the process needed to write [React Testing Library](https://testing-library.com/docs/react-testing-library/intro/) tests for components that consume data from RTK Query.


Since we are writing unit tests and not integration tests we need to figure out a way to mock our APIs. If we look at the [source code](https://github.com/reduxjs/redux-toolkit/blob/64a30d83384d77bcbc59231fa32aa2f1acd67020/packages/toolkit/src/query/tests/buildHooks.test.tsx) for tests in
RTK Query we can see that they use [msw](https://www.npmjs.com/package/msw) to mock thier API's. We will also use this package.


## Prerequisites


First we will set up a simple

```typescript
import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/query/react';

const reducerPath = 'api';
export default createApi({
    reducerPath,
    tagTypes: [reducerPath],
    baseQuery: fetchBaseQuery({ baseUrl: `/${reducerPath}/` }),
    endpoints: (builder) => ({
        get: builder.query({
            query: () => reducerPath,
            providesTags: [reducerPath ]
        }),
        update: builder.mutation({
            query(item) {
                return {
                    url: `${reducerPath}/${item.id}`,
                    method: 'PUT',
                    body: item,
                };
            },
            invalidatesTags: [reducerPath]
        }),
    }),
});
```

```typescript
import { configureStore } from '@reduxjs/toolkit';
import { setupListeners } from '@reduxjs/toolkit/query';
import api from './api.ts';

export const store = configureStore({
    reducer: {
        [api.reducerPath]: apireducer,
    },
    middleware: (getDefaultMiddleware) => getDefaultMiddleware().concat(api.middleware)
});

setupListeners(store.dispatch);

export type RootState = ReturnType<typeof store.getState>
export const { useGetQuery, useUpdateMutation, util } = api;

```




## Setup

```
npm install msw --save-dev
```